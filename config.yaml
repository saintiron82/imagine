ai_mode:
  auto_detect: false
  override: pro
  tiers:
    pro:
      preprocess:
        aspect_ratio_mode: contain
        max_edge: 768
        padding_color: '#FFFFFF'
      text_embed:
        dimensions: 1024
        model: qwen3-embedding:0.6b
      visual:
        dimensions: 1152
        model: google/siglip2-so400m-patch16-naflex
      vlm:
        backend: auto
        batch_size: 8
        device: auto
        model: Qwen/Qwen3-VL-4B-Instruct
        backends:
          darwin:
            backend: mlx
            model: mlx-community/Qwen3-VL-4B-Instruct-4bit
            batch_size: 1
            fallback: transformers
          windows:
            backend: transformers
            model: Qwen/Qwen3-VL-4B-Instruct
            batch_size: 8
          linux:
            backend: transformers
            model: Qwen/Qwen3-VL-4B-Instruct
            batch_size: 8
      vram_max: 16384
      vram_min: 8192
    standard:
      preprocess:
        aspect_ratio_mode: contain
        max_edge: 512
        padding_color: '#FFFFFF'
      text_embed:
        dimensions: 1024
        model: qwen3-embedding:0.6b
      visual:
        dimensions: 1152
        model: google/siglip2-so400m-patch16-naflex
      vlm:
        backend: transformers
        batch_size: 16
        device: auto
        model: Qwen/Qwen3-VL-2B-Instruct
      vram_max: 6144
    ultra:
      preprocess:
        aspect_ratio_mode: contain
        max_edge: 1024
        padding_color: '#FFFFFF'
      text_embed:
        dimensions: 4096
        model: qwen3-embedding:8b
      visual:
        dimensions: 1152
        model: google/siglip2-so400m-patch16-naflex
      vlm:
        backend: auto
        device: auto
        dtype: bfloat16
        model: qwen3-vl:8b
        backends:
          windows:
            backend: ollama
            model: qwen3-vl:8b
            batch_size: 1
          darwin:
            backend: mlx
            model: mlx-community/Qwen3-VL-8B-Instruct-4bit
            batch_size: 1
            fallback: transformers
          linux:
            backend: vllm
            model: Qwen/Qwen3-VL-8B-Instruct
            batch_size: 16
            fallback: ollama
      vram_min: 20480
embedding:
  structure:
    require_local_model: true
  text:
    dimensions: 1024
    enabled: true
    instruction_prefix: ''
    model: qwen3-embedding:0.6b
  visual:
    dimensions: 1152
    model: google/siglip2-so400m-patch16-naflex
runtime:
  ollama_version: 0.15.2
  pin_version: false
batch_processing:
  enabled: true
  skip_verify_hash: false
  db_writer:
    batch_size: 500
    flush_interval_s: 0.15
    max_queue_size: 1024
  adaptive:
    enabled: true
    memory_budget_gb: 20
    vlm_initial_batch: 2
    vv_initial_batch: 4
    mv_initial_batch: 16
registered_folders:
  folders:
    - /Users/saintiron/imageDB/마캬베리즈무
  auto_scan: false
last_session:
  folders: []
search:
  candidate:
    fts_topn_cut: 2000
    full_scan_threshold: 10000
    hard_no_full_scan: true
    no_cut_if_under: 200
  fts:
    auto_rebuild_on_version_mismatch: true
    bm25_weights:
      meta_strong: 3
      meta_weak: 1.5
  rrf:
    candidate_multiplier: 5
    k: 60
    preset: balanced
    presets:
      balanced:
        m: 0.3
        s: 0.4
        v: 0.3
      keyword:
        m: 0.4
        s: 0.35
        v: 0.25
      fact:
        m: 0.6
        s: 0.25
        v: 0.15
      semantic:
        m: 0.25
        s: 0.55
        v: 0.2
      visual:
        m: 0.15
        s: 0.35
        v: 0.5
  rerank:
    enabled: true
    pool_size: 120
  threshold:
    text_vec: 0.15
    visual: 0.05
server:
  enabled: false
  host: 0.0.0.0
  port: 8000
  workers: 4
  cors_origins:
    - http://localhost:9274
    - http://localhost:3000
  auth:
    jwt_secret: change-this-secret-in-production
    access_token_expire_minutes: 15
    refresh_token_expire_days: 7
  storage:
    mode: server_upload
    upload_dir: ./uploads
    thumbnail_dir: ./thumbnails
    max_file_size_mb: 500
  queue:
    assignment_timeout_minutes: 30
    max_retries: 3
    claim_batch_size: 10
worker:
  server_url: http://localhost:8000
  email: ''
  password: ''
  claim_batch_size: 5
  poll_interval_seconds: 30
storage:
  path_style: posix
thumbnail:
  format: png
  index_composite_bg: '#FFFFFF'
  keep_alpha: true
  max_size: 1024
vision:
  fail_if_cpu_on_macos: true
  keep_alive: 5m
  max_retries: 2
  model: qwen3-vl:8b
  ollama_host: http://localhost:11434
  require_local_models: true
  temperature: 0.1
app:
  mode: server
