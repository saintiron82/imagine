# í˜„ì¬ ë©”íƒ€ë°ì´í„° êµ¬ì¡° ë¬¸ì œì  ë¶„ì„

## ğŸš¨ ë°œê²¬ëœ ë¬¸ì œë“¤

### ë¬¸ì œ 1: semantic_tagsê°€ ë¬´ì˜ë¯¸í•¨

**í˜„ì¬ ìƒíƒœ:**
```json
{
  "semantic_tags": "ã‚°ãƒ«ãƒ¼ãƒ—",      // "ê·¸ë£¹"ë§Œ
  "semantic_tags": "ç©º â˜† bg",      // ì¼ë³¸ì–´ ë ˆì´ì–´ ì´ë¦„ë§Œ
  "semantic_tags": "ê·¸ë£¹"           // ê¸°ë³¸ ë ˆì´ì–´ ì´ë¦„ë§Œ
}
```

**ë¬¸ì œì :**
- âŒ ë ˆì´ì–´ **ì´ë¦„**ë§Œ ì¶”ì¶œ (ì‹¤ì œ **ë‚´ìš©**ì€ ëª¨ë¦„)
- âŒ "ê·¸ë£¹", "ë ˆì´ì–´ 1" ê°™ì€ ê¸°ë³¸ ì´ë¦„ì€ ì˜ë¯¸ ì—†ìŒ
- âŒ ì¼ë³¸ì–´/íŠ¹ìˆ˜ë¬¸ì ì„ì—¬ì„œ ê²€ìƒ‰ ë¶ˆê°€
- âŒ ì´ë¯¸ì§€ê°€ ë¬´ì—‡ì¸ì§€ ì „í˜€ ì•Œ ìˆ˜ ì—†ìŒ

**ì›ì¸:**
```python
# backend/parser/cleaner.py
def build_semantic_tags(layer_paths):
    """ë ˆì´ì–´ 'ì´ë¦„'ë§Œ ëª¨ìŒ"""
    cleaned_names = []
    for path in layer_paths:
        cleaned = clean_layer_name(part)  # ì´ë¦„ë§Œ ì •ì œ
        if cleaned:
            cleaned_names.append(cleaned)
    return ' '.join(cleaned_names)  # "ê·¸ë£¹ ë ˆì´ì–´"
```

**ê²°ê³¼:**
- `semantic_tags: "ê·¸ë£¹"` â† **ì´ê²Œ ë¬´ìŠ¨ ì´ë¯¸ì§€ì¸ì§€ ì•Œ ìˆ˜ ì—†ìŒ**

---

### ë¬¸ì œ 2: content_type ì¶”ë¡ ì´ ë¶€ì •í™•í•¨

**í˜„ì¬ ìƒíƒœ:**
```json
{
  "name": "ç©º",                    // "í•˜ëŠ˜" (ì¼ë³¸ì–´)
  "content_type": "character",     // "ìºë¦­í„°"ë¡œ ì˜ëª» ë¶„ë¥˜
  "size": [4400, 1304],
  "position": [0, 224]
}
```

**ë¬¸ì œì :**
- âŒ í¬ê¸°ì™€ ìœ„ì¹˜ë§Œìœ¼ë¡œ ì¶”ë¡  (ë¶€ì •í™•)
- âŒ "ç©º" (í•˜ëŠ˜)ë¥¼ "character"ë¡œ ë¶„ë¥˜
- âŒ ì‹¤ì œ ì´ë¯¸ì§€ ë‚´ìš©ì„ ì•ˆ ë³´ê³  ì¶”ì¸¡ë§Œ í•¨

**ì›ì¸:**
```python
# backend/parser/cleaner.py : infer_content_type()
if distance_from_center / max_distance < 0.3:
    if area_ratio > 0.1:
        return 'character'  # ì¤‘ì•™ + í° ë ˆì´ì–´ = ìºë¦­í„°?
```

**ê²°ê³¼:**
- í•˜ëŠ˜ ë°°ê²½ë„ "ìºë¦­í„°"ë¡œ ë¶„ë¥˜
- ì‹¤ì œ ìºë¦­í„°ëŠ” "object"ë¡œ ë¶„ë¥˜ë  ìˆ˜ë„ ìˆìŒ

---

### ë¬¸ì œ 3: text_contentê°€ í•­ìƒ ë¹„ì–´ìˆìŒ

**í˜„ì¬ ìƒíƒœ:**
```json
{
  "text_content": [],              // í•­ìƒ ë¹ˆ ë°°ì—´
  "translated_text": [],
  "used_fonts": []
}
```

**ë¬¸ì œì :**
- âŒ PSD í…ìŠ¤íŠ¸ ë ˆì´ì–´ ì¶”ì¶œ ì‹¤íŒ¨
- âŒ ì´ë¯¸ì§€ ì† í…ìŠ¤íŠ¸ OCR ì—†ìŒ
- âŒ "SALE 50%", "ì—¬ë¦„ íŠ¹ê°€" ê°™ì€ í…ìŠ¤íŠ¸ ê²€ìƒ‰ ë¶ˆê°€

**ì›ì¸:**
1. PSD í…ìŠ¤íŠ¸ ë ˆì´ì–´ ì¶”ì¶œ ë¡œì§ ë¬¸ì œ
2. OCR ìì²´ê°€ ì—†ìŒ (Phase 4 ë¯¸êµ¬í˜„)

**ê²°ê³¼:**
- í…ìŠ¤íŠ¸ ê¸°ë°˜ ê²€ìƒ‰ ë¶ˆê°€ëŠ¥
- "50% í• ì¸" ë°°ë„ˆë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ

---

### ë¬¸ì œ 4: ë ˆì´ì–´ ì´ë¦„ì´ ì¼ë³¸ì–´/íŠ¹ìˆ˜ë¬¸ì

**í˜„ì¬ ìƒíƒœ:**
```json
{
  "layer_name": "ç©º",              // í•˜ëŠ˜ (ì¼ë³¸ì–´)
  "layer_name": "â˜†",              // ë³„ (íŠ¹ìˆ˜ë¬¸ì)
  "layer_name": "ã‚°ãƒ«ãƒ¼ãƒ— 1"        // ê·¸ë£¹ 1 (ì¼ë³¸ì–´)
}
```

**ë¬¸ì œì :**
- âŒ í•œêµ­ì–´/ì˜ì–´ë¡œ ê²€ìƒ‰ ë¶ˆê°€
- âŒ ì˜ë¯¸ íŒŒì•… ì–´ë ¤ì›€
- âŒ ë²ˆì—­ì´ ìˆê¸´ í•˜ì§€ë§Œ ë ˆì´ì–´ ì´ë¦„ë§Œ ë²ˆì—­ (ë‚´ìš© ì•„ë‹˜)

---

### ë¬¸ì œ 5: layer_countê°€ ì´ìƒí•¨

**í˜„ì¬ ìƒíƒœ:**
```json
{
  "file_name": "#08_c130BG2-133.psd",
  "layer_count": 1,                // ë ˆì´ì–´ 1ê°œ?
  "layer_tree": {
    "children": [
      { "name": "ã‚°ãƒ«ãƒ¼ãƒ— 1", "kind": "pixel" }
    ]
  }
}
```

**ë¬¸ì œì :**
- âŒ PSDì¸ë° ë ˆì´ì–´ê°€ 1ê°œë§Œ?
- âŒ ë³‘í•©ëœ íŒŒì¼ì´ê±°ë‚˜ íŒŒì‹± ì‹¤íŒ¨
- âŒ ë ˆì´ì–´ë³„ ë¶„ì„ ë¶ˆê°€ëŠ¥

---

## ğŸ¯ ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ê²ƒ vs í˜„ì¬ ìƒíƒœ

### ì‚¬ìš©ì ë¹„ì „ (ì´ìƒì ì¸ ë©”íƒ€ë°ì´í„°)

```json
{
  "id": "summer_promo_layer_005",
  "document": "í•´ë³€ ë°°ê²½ì— 'ì—¬ë¦„ ëŒ€ì„¸ì¼ 50%'ë¼ëŠ” í…ìŠ¤íŠ¸ê°€ ìˆëŠ” í”„ë¡œëª¨ì…˜ ë°°ë„ˆ",

  "metadata": {
    // === ì¶œì²˜ ì •ë³´ ===
    "source_file": "summer_promo.psd",
    "layer_name": "Banner_Sale",
    "layer_index": 5,

    // === ë¬¼ë¦¬ ì •ë³´ (Python) ===
    "layer_type": "pixel",
    "width": 1200,
    "height": 400,
    "pos_x": 150,
    "pos_y": 300,

    // === AI ë¶„ì„ (Qwen/Florence) ===
    "ai_caption": "í•´ë³€ ë°°ê²½ì— ì„¸ì¼ ë¬¸êµ¬ê°€ ì íŒ í”„ë¡œëª¨ì…˜ ë°°ë„ˆ",
    "ai_tags": "summer,beach,banner,sale,promotion",
    "ai_style": "minimalist,modern,bright",
    "dominant_color": "#007BFF",

    // === OCR ===
    "ocr_text": "ì—¬ë¦„ ëŒ€ì„¸ì¼ 50%",
    "font_family": "Noto Sans Bold",

    // === ì‚¬ìš©ì ê´€ë¦¬ ===
    "user_tags": "2026_campaign",
    "status": "approved",
    "project_name": "summer_campaign_2026"
  }
}
```

### í˜„ì¬ ìƒíƒœ (ì‹¤ì œ ë©”íƒ€ë°ì´í„°)

```json
{
  "file_path": "C:\\Images\\ë°¤\\#08_c130BG2-133.psd",
  "file_name": "#08_c130BG2-133.psd",
  "format": "PSD",

  // === ë¬¸ì œ: ì˜ë¯¸ ì—†ëŠ” íƒœê·¸ ===
  "semantic_tags": "ã‚°ãƒ«ãƒ¼ãƒ—",     // âŒ "ê·¸ë£¹"ë§Œ
  "translated_tags": "ê·¸ë£¹",        // âŒ ë²ˆì—­ë„ ë¬´ì˜ë¯¸

  // === ë¬¸ì œ: ë¹ˆ ë°ì´í„° ===
  "text_content": [],              // âŒ í…ìŠ¤íŠ¸ ì—†ìŒ
  "used_fonts": [],                // âŒ í°íŠ¸ ì—†ìŒ

  // === ë¬¸ì œ: AI ë¶„ì„ ì—†ìŒ ===
  "ai_caption": null,              // âŒ ì—†ìŒ
  "ai_tags": null,                 // âŒ ì—†ìŒ
  "ocr_text": null,                // âŒ ì—†ìŒ
  "dominant_color": null,          // âŒ ì—†ìŒ

  // === ë¬¸ì œ: ë ˆì´ì–´ ì •ë³´ ë¶€ì¡± ===
  "layer_count": 1,                // âŒ 1ê°œ?
  "layer_tree": {
    "children": [{
      "name": "ã‚°ãƒ«ãƒ¼ãƒ— 1",
      "content_type": "background"  // âŒ ì¶”ë¡  ë¶€ì •í™•
    }]
  }
}
```

---

## ğŸ“Š ë¹„êµ í‘œ

| í•­ëª© | í˜„ì¬ ìƒíƒœ | ë¬¸ì œì  | í•„ìš”í•œ ê²ƒ |
|------|----------|--------|-----------|
| **semantic_tags** | "ê·¸ë£¹" | ë ˆì´ì–´ ì´ë¦„ë§Œ | ì‹¤ì œ ë‚´ìš© ì„¤ëª… |
| **text_content** | [] | ë¹„ì–´ìˆìŒ | OCR í…ìŠ¤íŠ¸ |
| **ai_caption** | null | ì—†ìŒ | AI ìƒì„± ìº¡ì…˜ |
| **ai_tags** | null | ì—†ìŒ | ìë™ íƒœê·¸ ì¶”ì¶œ |
| **content_type** | "background" | ì¶”ë¡  ë¶€ì •í™• | AI ì •í™• ë¶„ë¥˜ |
| **ocr_text** | null | ì—†ìŒ | ì´ë¯¸ì§€ ì† í…ìŠ¤íŠ¸ |
| **dominant_color** | null | ì—†ìŒ | ìƒ‰ìƒ ë¶„ì„ |
| **layer_count** | 1 | íŒŒì‹± ë¬¸ì œ? | ì‹¤ì œ ë ˆì´ì–´ ìˆ˜ |

---

## ğŸ”§ í•´ê²° ë°©ë²•

### ì¦‰ì‹œ ìˆ˜ì • ê°€ëŠ¥ (Phase 1-3 ê°œì„ )

**1. ë ˆì´ì–´ íŒŒì‹± ê°œì„ **
```python
# PSD íŒŒì‹± ë¡œì§ ì ê²€
# - ëª¨ë“  ë ˆì´ì–´ê°€ ì œëŒ€ë¡œ ì¶”ì¶œë˜ëŠ”ì§€ í™•ì¸
# - ê·¸ë£¹ ë ˆì´ì–´ ì¬ê·€ ìˆœíšŒ í™•ì¸
```

**2. í…ìŠ¤íŠ¸ ë ˆì´ì–´ ì¶”ì¶œ ê°•í™”**
```python
# backend/parser/psd_parser.py
# _extract_text_layer() ë¡œì§ ê°œì„ 
# - engine_dict êµ¬ì¡° ì¬í™•ì¸
# - í°íŠ¸ ì •ë³´ ì¶”ì¶œ ê°•í™”
```

**3. cleaner.py ê°œì„ **
```python
# MEANINGLESS_NAMESì— ì¼ë³¸ì–´ ì¶”ê°€
MEANINGLESS_NAMES = {
    'layer', 'ë ˆì´ì–´', 'group', 'ê·¸ë£¹',
    'ã‚°ãƒ«ãƒ¼ãƒ—', 'ç©º', 'â˜†'  # ì¼ë³¸ì–´ ê¸°ë³¸ ì´ë¦„
}
```

---

### Phase 4ë¡œ ê·¼ë³¸ í•´ê²°

**í•„ìš”í•œ ê²ƒ:**
1. **Vision Language Model** (Qwen/Florence)
   - ì´ë¯¸ì§€ë¥¼ ë³´ê³  ì‹¤ì œ ë‚´ìš© ì„¤ëª…
   - "í•´ë³€ ë°°ê²½ì˜ í”„ë¡œëª¨ì…˜ ë°°ë„ˆ"

2. **OCR**
   - ì´ë¯¸ì§€ ì† í…ìŠ¤íŠ¸ ì½ê¸°
   - "ì—¬ë¦„ ëŒ€ì„¸ì¼ 50%"

3. **ìë™ íƒœê·¸ ì¶”ì¶œ**
   - AIê°€ ë¶„ì„í•œ ê²°ê³¼ì—ì„œ í‚¤ì›Œë“œ ì¶”ì¶œ
   - "summer, beach, sale, promotion"

4. **ìƒ‰ìƒ ë¶„ì„**
   - ëŒ€í‘œ ìƒ‰ìƒ ì¶”ì¶œ
   - "#007BFF"

5. **ì •í™•í•œ ë¶„ë¥˜**
   - ì‹¤ì œ ì´ë¯¸ì§€ ë‚´ìš© ê¸°ë°˜ ë¶„ë¥˜
   - "background", "character", "ui" ì •í™•íˆ êµ¬ë¶„

---

## ğŸ¯ Phase 4 êµ¬í˜„ ì‹œ ê°œì„  íš¨ê³¼

### Before (í˜„ì¬)
```json
{
  "semantic_tags": "ê·¸ë£¹",
  "text_content": [],
  "layer_count": 1
}
```

**ê²€ìƒ‰:**
- âŒ "ë°°ë„ˆ" ê²€ìƒ‰ â†’ ì°¾ì„ ìˆ˜ ì—†ìŒ
- âŒ "50%" ê²€ìƒ‰ â†’ ì°¾ì„ ìˆ˜ ì—†ìŒ
- âŒ "ì—¬ë¦„" ê²€ìƒ‰ â†’ ì°¾ì„ ìˆ˜ ì—†ìŒ

### After (Phase 4 ì™„ë£Œ í›„)
```json
{
  "ai_caption": "í•´ë³€ ë°°ê²½ì— ì—¬ë¦„ ì„¸ì¼ ë¬¸êµ¬ê°€ ìˆëŠ” í”„ë¡œëª¨ì…˜ ë°°ë„ˆ",
  "ai_tags": "summer,beach,banner,sale,promotion,50%",
  "ocr_text": "ì—¬ë¦„ ëŒ€ì„¸ì¼ 50%",
  "dominant_color": "#007BFF",
  "layer_count": 15  // ì œëŒ€ë¡œ íŒŒì‹±ë¨
}
```

**ê²€ìƒ‰:**
- âœ… "ë°°ë„ˆ" ê²€ìƒ‰ â†’ **ì°¾ìŒ** (ai_tagsì— "banner")
- âœ… "50%" ê²€ìƒ‰ â†’ **ì°¾ìŒ** (ocr_textì— "50%")
- âœ… "ì—¬ë¦„" ê²€ìƒ‰ â†’ **ì°¾ìŒ** (ai_captionì— "ì—¬ë¦„")
- âœ… "íŒŒë€ìƒ‰" ê²€ìƒ‰ â†’ **ì°¾ìŒ** (dominant_color)

---

## ğŸ“‹ ë‹¤ìŒ ë‹¨ê³„

### 1. ê¸°ì¡´ íŒŒì‹± ë¡œì§ ì ê²€ (1ì‹œê°„)
```powershell
# ë ˆì´ì–´ ì œëŒ€ë¡œ ì¶”ì¶œë˜ëŠ”ì§€ í™•ì¸
python -c "
from backend.parser.psd_parser import PSDParser
parser = PSDParser()
result = parser.parse('test.psd')
print(f'Layer count: {result.asset_meta.layer_count}')
print(f'Text content: {result.asset_meta.text_content}')
"
```

### 2. Phase 4 ì‹œì‘ (ë³¸ê²© í•´ê²°)
```powershell
# Vision ë¶„ì„ ëª¨ë“ˆ êµ¬í˜„
/unit-start  # U-015: Vision ëª¨ë“ˆ ê¸°ë°˜ êµ¬ì¶•
```

### 3. ê¸°ì¡´ 194ê°œ íŒŒì¼ ì¬ì²˜ë¦¬
```powershell
# Phase 4 ì™„ë£Œ í›„
python backend/pipeline/ingest_engine.py --watch "C:\Images\ë°¤"
# â†’ AI ë¶„ì„ ì¶”ê°€ëœ ìƒˆ ë©”íƒ€ë°ì´í„° ìƒì„±
```

---

## ğŸ’¡ ê²°ë¡ 

**í˜„ì¬ ë©”íƒ€ë°ì´í„°ëŠ” "ê»ë°ê¸°ë§Œ" ìˆëŠ” ìƒíƒœ:**
- âœ… íŒŒì¼ ì •ë³´ (ê²½ë¡œ, í¬ê¸°, í•´ìƒë„)
- âœ… ë ˆì´ì–´ êµ¬ì¡° (ì´ë¦„, ìœ„ì¹˜, í¬ê¸°)
- âŒ **ì‹¤ì œ ë‚´ìš©ì€ ëª¨ë¦„** (ì´ë¯¸ì§€ê°€ ë­”ì§€ ì„¤ëª… ì—†ìŒ)
- âŒ **ê²€ìƒ‰ ë¶ˆê°€ëŠ¥** (í‚¤ì›Œë“œ ë§¤ì¹­ ì•ˆë¨)
- âŒ **í…ìŠ¤íŠ¸ ì½ê¸° ë¶ˆê°€** (OCR ì—†ìŒ)

**Phase 4 êµ¬í˜„í•˜ë©´:**
- âœ… AIê°€ ì´ë¯¸ì§€ ë‚´ìš© ì„¤ëª…
- âœ… ìë™ íƒœê·¸ ì¶”ì¶œ
- âœ… OCRë¡œ í…ìŠ¤íŠ¸ ê²€ìƒ‰
- âœ… ìƒ‰ìƒ, ìŠ¤íƒ€ì¼ ë¶„ì„
- âœ… ì˜ë¯¸ ìˆëŠ” ê²€ìƒ‰ ê°€ëŠ¥

**ì‚¬ìš©ìë‹˜ì´ ë§ìŠµë‹ˆë‹¤:**
> "í•´ë‹¹ ë©”íƒ€ ì •ë³´ë„ ì´ìƒí•˜ê²Œ ë§Œë“¤ì–´ì ¸ ìˆìŒ"

í˜„ì¬ëŠ” **í˜•ì‹ì ì¸ ì •ë³´**ë§Œ ìˆê³ , **ì˜ë¯¸ ìˆëŠ” ë¶„ì„**ì€ ì—†ìŠµë‹ˆë‹¤.

---

**ì‘ì„±ì¼**: 2026-02-06
**ë‹¤ìŒ ë‹¨ê³„**: Phase 4 ì‹œì‘ â†’ ê·¼ë³¸ í•´ê²°
