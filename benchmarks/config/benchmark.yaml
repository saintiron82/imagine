# Benchmark Configuration
# 각 엔진/설정을 독립 실행하고 점수를 기록하는 방식

# --- 엔진 정의 ---
engines:
  triaxis:
    type: internal
    description: "Triaxis VV+MV+FTS (자사 전체 시스템)"
    search_mode: triaxis
  vv_only:
    type: internal
    description: "SigLIP2 VV 단독 (ablation)"
    search_mode: triaxis
    rrf_override: { v: 1.0, s: 0.0, m: 0.0 }
  mv_only:
    type: internal
    description: "Qwen3-Embedding MV 단독 (ablation)"
    search_mode: triaxis
    rrf_override: { v: 0.0, s: 1.0, m: 0.0 }
  fts_only:
    type: internal
    description: "FTS5 BM25 키워드만 (ablation)"
    search_mode: fts
  random:
    type: random
    description: "Random baseline (하한선)"
  # 아래는 추후 추가 (pip install 필요)
  # openclip_b32:
  #   type: openclip
  #   model: ViT-B-32
  #   pretrained: laion2b_s34b_b79k
  #   description: "OpenCLIP ViT-B/32 (업계 표준 CLIP)"
  # jina_clip_v2:
  #   type: jina_clip
  #   model: jinaai/jina-clip-v2
  #   description: "Jina CLIP v2 (한국어 네이티브)"

# --- 쿼리셋 ---
dataset:
  smoke: data/queries/smoke_50.jsonl
  full: data/queries/full_300.jsonl
  labels: data/labels/relevance_v1.jsonl

# --- 메트릭 ---
metrics:
  primary: ndcg@10
  secondary:
    - recall@50
    - mrr@10
  performance:
    - p95_latency_ms
    - error_rate

# --- Gate 규칙 (기준선 대비 허용 하락폭) ---
gates:
  ndcg@10:
    max_drop: 0.01       # 1.0%p
    action: block
  recall@50:
    max_drop: 0.02       # 2.0%p
    action: block
  p95_latency_ms:
    max_increase_pct: 0.20  # 20%
    action: block
  error_rate:
    max_increase: 0.005  # 0.5%p
    action: block

# --- 실행 설정 ---
run:
  top_k: 50              # 검색 결과 상위 N개
  threshold: 0.0         # 점수 임계값 (0 = 제한 없음)
  timeout_s: 300         # 쿼리당 타임아웃
  diagnostic: true       # Triaxis 진단 데이터 수집

# --- 통계 검정 ---
statistics:
  bootstrap_n: 10000
  confidence: 0.95

# --- 출력 ---
output:
  runs_dir: benchmarks/runs        # 개별 실행 결과 저장
  reports_dir: benchmarks/reports   # 비교 리포트
  baselines_dir: benchmarks/baselines
